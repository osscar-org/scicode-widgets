[tox]
lint_folders =
    "{toxinidir}/src" \
    "{toxinidir}/tests" \
    "{toxinidir}/docs/src/"

envlist =
    lint
    tests

[testenv]

[testenv:tests]
setenv =
    # this is needed to run selenium on a machine without display to do CI
    SELENIUM_FIREFOX_DRIVER_ARGS = {env:SELENIUM_FIREFOX_DRIVER_ARGS:--headless}
    # use the jupyter config in the tox environment
    # otherwise the users config is used
    JUPYTER_CONFIG_DIR={envdir}/etc/jupyter
    JUPYTER_DATA_DIR={envdir}/share/jupyter
deps =
    jupyter
    pytest
    # fixing selenium version to have backwards-compatibility with pytest-selenium
    # see https://github.com/robotframework/SeleniumLibrary/issues/1835#issuecomment-1581426365
    selenium==4.9.0 
    pytest-selenium
    jupytext==1.15.0
commands =
    # converts the python files to ipython notebooks
    jupytext tests/notebooks/*.py --to ipynb
    pytest {posargs:-s -v} --driver Firefox

[testenv:docs]
deps =
    -r docs/requirements.txt
commands = sphinx-build {posargs:-E} -b html docs/src docs/build/html

[testenv:format]
# formats project source code files
skip_install = true
deps =
    black
    blackdoc
    isort
commands =
    black {[tox]lint_folders}
    blackdoc {[tox]lint_folders}
    isort {[tox]lint_folders}

[testenv:lint]
# this environement lints the Python code with flake8 (code linter),
# black (code formatter), and isort (sorting of imports)
package = skip
deps =
    flake8
    flake8-bugbear
    black
    blackdoc
    isort

commands =
    flake8 {[tox]lint_folders}
    black --check --diff {[tox]lint_folders}
    blackdoc --check --diff {[tox]lint_folders}
    isort --check-only --diff {[tox]lint_folders}

[flake8]
max_line_length = 88
